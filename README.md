# 汽车发动机缸盖燃烧室容积数字化计量技术大作业

## 项目简介

本项目实现了基于点云数据的汽车发动机缸盖燃烧室容积数字化计量技术，包含数值数据分析和图像数据分析两个部分。

### 主要功能

1. **数值数据分析**
   - 点云数据预处理（无效点识别、坐标系转换）
   - 三种滤波算法（距离阈值滤波、孤立点滤波、K近邻统计滤波）
   - 燃烧室点云分离（边界识别、最小二乘法圆拟合）

2. **图像数据分析**
   - 3D点云投影到2D平面
   - 灰度图像生成
   - 边缘检测和轮廓提取

## 技术实现

### 理论基础

实现基于以下理论文档：
- **3.2.1 距离阈值滤波**: 基于Z坐标阈值滤除距离过远的点
- **3.2.2 孤立点滤波**: 检测连续非NaN点数量，滤除孤立点群
- **3.2.3 K近邻统计滤波**: 使用3σ法则检测和滤除离群点
- **5.1.1 燃烧室分离**: 边界点识别和最小二乘法圆拟合

### 数据格式

- 输入：819,200行点云数据 (1280条激光线 × 640点/线)
- 格式：每行包含X Y Z三个坐标值，空格分隔
- 无效点：用固定坐标(-0.017861, 0.228109, 18.9038)标记
- 理论测量点：每5个点中的第1个点

## 项目结构

```
大作业/
├── config.py                  # 配置参数
├── main.py                    # 主程序入口
├── requirements.txt           # 依赖包列表
├── README.md                 # 项目说明
├── src/                      # 源代码模块
│   ├── data_loader.py        # 数据加载和预处理
│   ├── filters.py            # 三种滤波算法
│   ├── combustion_chamber.py # 燃烧室分离算法
│   └── image_processor.py    # 图像处理模块
├── 大作业实验数据/            # 数据文件
│   ├── 8.txt                # 主数据文件(80万行)
│   └── test.txt             # 测试数据
├── output/                   # 输出结果
│   ├── grayscale_image.png   # 灰度投影图像
│   ├── edges.png            # 边缘检测结果
│   ├── result_visualization.png # 可视化结果
│   └── analysis_results.json # 数值结果
└── report/                   # 分析报告
    └── analysis_report.txt   # 完整分析报告
```

## 使用方法

### 1. 环境准备

```bash
# 安装依赖包
pip install -r requirements.txt
```

### 2. 运行分析

```bash
# 运行完整分析流程
python main.py
```

### 3. 查看结果

- **处理日志**: `homework_process.log`
- **分析报告**: `report/analysis_report.txt`
- **可视化结果**: `output/` 目录下的图像文件

## 算法参数

可在 `config.py` 中调整以下参数：

### 滤波参数
- `distance_threshold`: 距离阈值滤波阈值 (默认: 0.11m)
- `isolate_min_continuous`: 孤立点滤波最小连续点数 (默认: 15)
- `knn_neighbors`: K近邻滤波邻居数量 (默认: 50)
- `knn_std_multiplier`: K近邻滤波标准差倍数 (默认: 3.0)

### 燃烧室分离参数
- `effective_radius_multiplier`: 有效区域半径倍数 (默认: 1.1)
- `boundary_z_threshold`: Z坐标边界阈值 (默认: 0.01)

### 图像处理参数
- `output_size`: 输出图像尺寸 (默认: 800×800)
- `canny_low_threshold`: Canny边缘检测低阈值 (默认: 50)
- `canny_high_threshold`: Canny边缘检测高阈值 (默认: 150)

## 主要特性

### 1. 鲁棒的数据处理
- 自动识别和处理无效点
- 支持大规模点云数据（80万点）
- 内存效率优化

### 2. 完整的滤波流水线
- 三阶段滤波：距离→孤立点→统计滤波
- 保持点云有序性
- 详细的滤波统计信息

### 3. 精确的几何分析
- 最小二乘法圆拟合（完整数学公式实现）
- 燃烧室几何特性分析
- 体积估算

### 4. 全面的图像分析
- 高质量的3D到2D投影
- 多种边缘检测算法
- 轮廓几何特性提取

### 5. 详细的结果报告
- 分步骤处理日志
- 综合分析报告
- 可视化结果展示

## 输出结果

### 数值分析结果
- 滤波统计：各阶段滤除的点数和保留率
- 燃烧室几何：深度、面积、体积等参数
- 圆拟合参数：圆心坐标和半径

### 图像分析结果
- 灰度投影图像
- 边缘检测结果
- 轮廓提取和几何分析
- 椭圆拟合参数

## 注意事项

1. **数据文件**: 确保数据文件路径正确，默认为 `大作业实验数据/8.txt`
2. **内存需求**: 处理80万点数据需要足够的内存（建议8GB+）
3. **处理时间**: 完整流程可能需要几分钟，请耐心等待
4. **依赖版本**: 确保安装了正确版本的依赖包

## 技术支持

如遇到问题，请检查：
1. 数据文件格式是否正确
2. 依赖包是否完整安装
3. 系统内存是否充足
4. Python版本是否兼容（建议3.7+）